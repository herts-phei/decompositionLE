---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)

library(decompositionLE)
library(tidyverse)
```

# decompositionLE

<!-- badges: start -->
[![CRAN status](https://www.r-pkg.org/badges/version/decompositionLE)](https://CRAN.R-project.org/package=decompositionLE)
[![Codecov test coverage](https://codecov.io/gh/herts-phei/decompositionLE/graph/badge.svg)](https://app.codecov.io/gh/herts-phei/decompositionLE)
[![R-CMD-check](https://github.com/herts-phei/decompositionLE/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/herts-phei/decompositionLE/actions/workflows/R-CMD-check.yaml)
<!-- badges: end -->

The goal of **decompositionLE** is to provide an easy to use implementation of life expectancy decomposition formulas for age bands, derived from *Ponnapalli, K. (2005)* In addition, there is a decomposition function for disease cause breakdown sourced from *Preston, S.H., Heuveline, P. and Guillot, M. (2001)*, as well as some useful helper plot functions.

## Installation

You can install the development version of decompositionLE from [GitHub](https://github.com/) with:

``` r
devtools::install_github("herts-phei/decompositionLE")
```

## Example

The package contains a built-in dataset of life table values for US women born in 1935 and 1995, `us_females`, sourced from *Ponnapalli, K. (2005)*.

```{r}
us_females
```

The dataset demonstrates usage of `decomp_age()`.

```{r}
decomp_age(us_females, method = "arriaga3", 
           age_col = "Age", e1 = "e1x", e2 = "e2x", l1 = "l1x", l2 = "l2x")
```

The package also contains a built-in dataset of age and cause decomposition of difference in Life Expectancies at birth, for India and China, males, 1990, `india_china_males_1990`, sourced from *Murray, C.J.L. and Lopez, A.D. (1996)*.

```{r}
india_china_males_1990
```

The dataset demonstrates usage of `decomp_disease()`.

```{r cols.print=9999, rows.print=9999}
decomp_disease(india_china_males_1990,
  breakdown = "proportion", age_col = "Age",
  diseases = c("CD", "NCD", "Injuries"),
  group_1 = "India", group_1_m = "India_nmx", 
  group_2 = "China", group_2_m = "China_nmx", 
  nDx = "nDx"
)
```

## References

*Ponnapalli, K. (2005). A comparison of different methods for decomposition of changes in expectation of life at birth and differentials in life expectancy at birth. Demographic Research, 12, pp.141â€“172. doi: https://doi.org/10.4054/demres.2005.12.7.*

*Preston, S.H., Heuveline, P. and Guillot, M. (2001). Demography : measuring and modeling population processes. Oxford ; Malden, Mass.: Blackwell Publishers.*
